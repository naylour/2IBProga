
1. [[#๐ ะะตัะตะฝะธะต ะดะปั `bin1.exe`|๐ ะะตัะตะฝะธะต ะดะปั `bin1.exe`]]
2. [[#๐ ะะตัะตะฝะธะต ะดะปั `bin2.exe`|๐ ะะตัะตะฝะธะต ะดะปั `bin2.exe`]]
3. [[#๐ ะะตัะตะฝะธะต ะดะปั `bin3.exe`|๐ ะะตัะตะฝะธะต ะดะปั `bin3.exe`]]
4. [[#๐ ะะตัะตะฝะธะต ะดะปั `bin4.exe`|๐ ะะตัะตะฝะธะต ะดะปั `bin4.exe`]]
5. [[#๐ ะะตัะตะฝะธะต ะดะปั `bin5.exe`|๐ ะะตัะตะฝะธะต ะดะปั `bin5.exe`]]

**ะัะฟะพะปะฝะธะป ัััะดะตะฝั ะบัััะฐ 2ะะ**
*ะฃะฑะฐะนะดัะปะปะพะทะพะดะฐ ะจะฐััะธััะธ*

## ๐ ะะตัะตะฝะธะต ะดะปั `bin1.exe`


![ะะตัะตะฝะธะต ะฟะตัะฒะพะณะพ ะฑะธะฝะฐัะฝะธะบะฐ](./assets/lesson_2_bin1.png)
### ๐ ะฅะพะด ะธััะปะตะดะพะฒะฐะฝะธั


ะะพัะปะต ะดะตะบะพะผะฟะธะปััะธะธ `bin1.exe` ัะดะฐะปะพัั ะฒะพัััะฐะฝะพะฒะธัั ะบะพะด, ะบะพัะพััะน ััะฐะฒะฝะธะฒะฐะตั ะฒัะพะดัััั ัััะพะบั ั `C-ัััะพะบะพะน` `"arctf{z3r0_0r_no7_0}"` ั ะฟะพะผะพััั `strcmp`.

ะคัะฝะบัะธั `strcmp` ััะฐะฒะฝะธะฒะฐะตั 2 `C-ัััะพะบะธ` ะธ ะฒัะดะฐัั 3 ะธััะพะดะฐ:
1. `0` - ัััะพะบะธ ัะฐะฒะฝั
2. `< 0` - ัััะพะบะฐ `s1` **"ะผะตะฝััะต"** ัััะพะบะธ `s2`(ะฟะตัะฒัะน ะฝะต ัะพะฒะฟะฐะฒัะธะน ัะธะผะฒะพะป ะฒ `s1` ะธะผะตะตั ะผะตะฝััะธะน ะบะพะด)
3. `> 0` โ ัััะพะบะฐ `s1` **"ะฑะพะปััะต"** ัััะพะบะธ `s2`.

### โ ะะฐัะพะปั

```
"arctf{z3r0_0r_no7_0}"
```



๐ ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฟัะพะฒะตัะบะฐ ะฒ `bin1.exe` ะฑัะดะตั ััะฟะตัะฝะพ ะฟัะพะนะดะตะฝะฐ ัะพะปัะบะพ ะฟัะธ ะฒะฒะพะดะต ัััะพะบะธ **`"arctf{z3r0_0r_no7_0}"`**.


## ๐ ะะตัะตะฝะธะต ะดะปั `bin2.exe`

![ะะตัะตะฝะธะต ะฒัะพัะพะณะพ ะฑะธะฝะฐัะฝะธะบะฐ](./assets/lesson_2_bin2.png)

### ๐ ะฅะพะด ะธััะปะตะดะพะฒะฐะฝะธั

ะะพัะปะต ะดะตะบะพะผะฟะธะปััะธะธ `bin2.exe` ัะดะฐะปะพัั ะฒะพัััะฐะฝะพะฒะธัั ะบะพะด, ะบะพัะพััะน ััะฐะฒะฝะธะฒะฐะตั ะฒัะพะดัััั ัััะพะบั `C-ัััะพะบั` ัะพ ะทะฝะฐัะตะฝะธัะผะธ ะธะท ะฟะตัะตะผะตะฝะฝัั `Str2` ะธ `aMiccheckH4y` ั ะฟะพะผะพััั `strcmp`.

---

#### ะะฝะฐัะตะฝะธะต ะฟะตัะตะผะตะฝะฝัั ะฒ ะฟะฐะผััะธ
- `Str2 = "MicCheck_h4w"`
- `aMiccheckH4y = "MicCheck_h4y"`


ะะฝะฐั ะบะฐะบ ัะฐะฑะพัะฐะตั ััะฝะบัะธั `strcmp` ะธ ะธััะพะดั ะธะท ััะปะพะฒะธะน ััะพ ะฟัะธ ะฟะตัะฒะพะผ ััะฐะฒะฝะตะฝะธะธ ะฒัะพะดััะฐั ัััะพะบะฐ ะดะพะปะถะฝะฐ ะฑััั "ะฑะพะปััะต", ะฐ ะฒะพ ะฒัะพัะพะผ "ะผะตะฝััะต", ะธ ัะพ, ััะพ ััะธ ัััะพะบะธ ะพะบะฐะฝัะธะฒะฐัััั ะฝะฐ ัะธะผะฒะพะปั `w` ะธ `y`, ััะพ ะฝะฐะผ ะดะฐัั ะฟัะตะดะฟะพะปะพะถะธัั, ััะพ ะฒัะพะดััะฐั ัััะพะบะฐ ะฒ ะบะพะฝัะต ะดะพะปะถะฝะฐ ะธะผะตัั ัะธะผะฒะพะป ะผะตะถะดั `w` ะธ `y` => `x`.


### โ ะัะพะดััะฐั ัััะพะบะฐ

```
MicCheck_h4x
```



๐ ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฟัะพะฒะตัะบะฐ ะฒ `bin2.exe` ะฑัะดะตั ััะฟะตัะฝะพ ะฟัะพะนะดะตะฝะฐ ัะพะปัะบะพ ะฟัะธ ะฒะฒะพะดะต ัััะพะบะธ **`MicCheck_h4x`**.


## ๐ ะะตัะตะฝะธะต ะดะปั `bin3.exe`

![ะะตัะตะฝะธะต ััะตััะตะณะพ ะฑะธะฝะฐัะฝะธะบะฐ](./assets/lesson_2_bin3.png)

### ๐ ะฅะพะด ะธััะปะตะดะพะฒะฐะฝะธั

ะะพัะปะต ะดะตะบะพะผะฟะธะปััะธะธ `bin3.exe` ัะดะฐะปะพัั ะฒะพัััะฐะฝะพะฒะธัั ััะฝะบัะธั ะฟัะพะฒะตัะบะธ ะบะพะดะฐ (`sub_40101D`).

ะฃัะปะพะฒะธะต ะฟัะพัะพะถะดะตะฝะธั:

1. ะะปะธะฝะฐ ัััะพะบะธ โ **17 ัะธะผะฒะพะปะพะฒ**.
2. ะะฐัะฐะปะพ ัััะพะบะธ โ `"333"` (`atoi(Str) == 333`).

#### ะััะฐะปัะฝัะต ัะธะผะฒะพะปั ะฟัะพะฒะตัััััั ัะตัะตะท ะฒัะฟะพะผะพะณะฐัะตะปัะฝัั ััะฝะบัะธั:

^9dcbbe

```c
int __cdecl sub_401000(int a1, int a2) {
    return *(char *)(a2 - 1 + a1);
}
```

ะะฐ ัะฐะผะพะผ ะดะตะปะต ััะพ ะพะฑััะฝะฐั ะฒัะฑะพัะบะฐ ัะธะผะฒะพะปะฐ ะฟะพ ะธะฝะดะตะบัั:

```c
char sub_401000(char *chars, int idx) {
    return chars[idx - 1];
}
```

---

### ๐ ะะฐะทะฑะพั ััะปะพะฒะธะน ะฟะพ ัะฐะณะฐะผ

#### ะะฐะทะพะฒัะต ััะตะฑะพะฒะฐะฝะธั

* `len(Str) == 17`
* `Str[0..2] = "333"`

ะัะพะณะพ: `333???????????????`

---

#### ะคะธะบัะธัะพะฒะฐะฝะฝัะต ัะธะผะฒะพะปั `'o'` (ASCII 111)

* `Str[4]  = 'o'`
* `Str[6]  = 'o'`
* `Str[10] = 'o'`

ะัะพะณะพ: `333?o?o??o???????`

---

#### ะััะฟะฟะฐ ะพะดะธะฝะฐะบะพะฒัั ัะธะผะฒะพะปะพะฒ `'g'` (ASCII 103)

ะฃัะปะพะฒะธัะผะธ ัััะฐะฝะพะฒะปะตะฝะพ, ััะพ ะพะดะธะฝะฐะบะพะฒั:
`Str[3], Str[5], Str[7], Str[9], Str[11], Str[13], Str[15]`

ะัะธััะผ ะบะพะฝะบัะตัะฝะพ ะฟัะพะฒะตััะตััั:

* `Str[15] = 'g'`
* ัะปะตะดะพะฒะฐัะตะปัะฝะพ, ะฒัะต ะฟะตัะตัะธัะปะตะฝะฝัะต ัะพะถะต `'g'`.

ะัะพะณะพ: `333gogog?gog?g?g?`

---

#### ะััะฟะฟะฐ ะพะดะธะฝะฐะบะพะฒัั ัะธะผะฒะพะปะพะฒ `'0'` (ASCII 48)

ะะดะธะฝะฐะบะพะฒั:
`Str[8], Str[12], Str[14], Str[16]`

ะัะธััะผ ะบะพะฝะบัะตัะฝะพ ะฟัะพะฒะตััะตััั:

* `Str[8] = '0'`
* ะทะฝะฐัะธั ะฒัะต ะธะท ะณััะฟะฟั `'0'`.

ะัะพะณะพ: `333gogog0gog0g0g0`

---

### โ ะัะพะณะพะฒะพะต ะบะพะดะพะฒะพะต ัะปะพะฒะพ

```
333gogog0gog0g0g0
```



๐ ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฟัะพะฒะตัะบะฐ ะฒ `bin3.exe` ะฑัะดะตั ััะฟะตัะฝะพ ะฟัะพะนะดะตะฝะฐ ัะพะปัะบะพ ะฟัะธ ะฒะฒะพะดะต ัััะพะบะธ **`"333gogog0gog0g0g0"`**.


## ๐ ะะตัะตะฝะธะต ะดะปั `bin4.exe`

![ะะตัะตะฝะธะต ัะตัะฒัััะพะณะพ ะฑะธะฝะฐัะฝะธะบะฐ](./assets/lesson_2_bin4.png)

### ๐ ะฅะพะด ะธััะปะตะดะพะฒะฐะฝะธั

ะะพัะปะต ะดะตะบะพะผะฟะธะปััะธะธ `bin4.exe` ัะดะฐะปะพัั ะฒะพัััะฐะฝะพะฒะธัั ััะฝะบัะธั ะฟัะพะฒะตัะบะธ ะบะพะดะฐ (`sub_40101D`).

ะคัะฝะบัะธั ะฟะพะปััะฐะตั ะฒะฒะพะด ะพั ะฟะพะปัะทะพะฒะฐัะตะปั, ัะพะทะดะฐัั ะฟะตัะตะผะตะฝะฝัั(`v1`) ะณะดะต ััะฐะฝะธั `ะดะปะธะฝั ัััะพะบะธ * 4`.

ะะฐะปะตะต ะธะดัั ะฟัะพะฒะตัะบะฐ ัะตัะตะท ััะฝะบัะธั `sub_401000`, ะบะพัะพัะฐั ะฒัััะตัะฐะปะฐัั ะฒ [[bin3#^9dcbbe|ะฟัะตะดัะดััะตะผ ะฑะธะฝะฐัะฝะธะบะต]]. `v1 == sub_401000(Str, 1)` ะพะทะฝะฐัะฐะตั ััะพ ะฟะตัะฒัะน ัะธะผะฒะพะป ะฒ ะฒะฒะตะดัะฝะฝะพะน ัััะพะบะต, ะดะพะปะถะตะฝ ะฑััั ัะธะผะฒะพะปะพะผ ะฟะพะด ASCII ะฝะพะผะตัั, ะบะพัะพััะน ะปะตะถะธั ะฒ ะฟะตัะตะผะตะฝะฝะพะน `v1`

#### strncmp

ะะฐะปะตะต ะธะดัั ััะฐะฒะฝะตะฝะธะต ะฟัะธ ะฟะพะผะพัะธ ััะฝะบัะธะธ `strncmp`, ะบะพัะพัะฐั ัะฐะฑะพัะฐะตั ัะฐะบ ะถะต, ะบะฐะบ ะธ `strcmp`, ะฝะพ ะผะพะถะตั ะพะณัะฐะฝะธัะธัั ะบะพะปะธัะตััะฒะพ ััะฐะฒะฝะธะฒะฐะตะผัั ัะปะตะผะตะฝัะพะฒ.

`!strncmp(Str, Str2, 8u)`

ะะฝะฐัะตะฝะธะต ะฟะตัะตะผะตะฝะฝะพะน `Str2` ะฒ ะฟะฐะผััะธ ัะฐะฒะฝะพ `4_points`

ะััะฐะถะตะฝะธะต ะฒััะต ะฒะตัะฝัั `true`, ัะพะปัะบะพ ะตัะปะธ ัััะพะบะธ ะฒะฟะปะพัั ะดะพ 8-ะณะพ ัะปะตะผะตะฝัะฐ ััะพะถะธ, ัะพ ะตััั ัะฐะฒะฝั `4_points`. ะัััะดะฐ ัะตะฟะตัั ัะปะตะดัะตั ััะพ `v1` ะดะพะปะถะตะฝ ะฑััั ัะธะผะฒะพะปะพะผ `4`, ัะพ ะตััั ัะธัะปะพ `52`. 

`52 / 4 = 13` - ะธะผะตะฝะฝะพ ัะฐะบะฐั ะดะปะธะฝะฐ ั ะฟะฐัะพะปั.

ะะฐะปะตะต ะธะดัั ัะฐะบะพะต ััะปะพะฒะธะต `!strcmp(Str1, aKomne)`, ะณะดะต `aKomne = "komne"`. ะะพั ััั ะฟัะพะธััะพะดะธั ัะฐะบ ะฝะฐะทัะฒะฐะตะผัะน `stack overflow`. ะัะพะณัะฐะผะผะฐ ััััะพะตะฝะฐ ัะฐะบ, ััะพ ะพะฝะฐ ะฝะฐะผะตัะตะฝะพ ะฟะพะทะฒะพะปัะตั ะฟะตัะตะฟะพะปะฝะธัั ะฑััะตั `Str` ััะพะฑั ะพััะฐะฒัะฐััั ัะฐััั ะฟะฐัะพะปั ะฟะตัะตัะปะฐ ะฒ ะฑััะตั `Str1`.

ะขะพ ะตััั, ะฟะพัะปะต ะฒะฒะพะดะฐ ะฟัะฐะฒะธะปัะฝะพะณะพ ะฟะฐัะพะปั, ะตะณะพ ัะฐััั ะฟะพัะปะต `4_points` ะฟะตัะตัะพะดะธั ะฒ `Str1`. ะัััะดะฐ ะดะตะปะฐะตะผ ะฒัะฒะพะด, ััะพ ััะปะพะฒะธะต ะฒะตัะฝัั `true`, ัะพะปัะบะพ ะตัะปะธ ัะธะผะฒะพะปั ะฒ `Str1` ัะพะฒะฟะฐะดัั ั `"komne"`. 

### โ ะัะพะณะพะฒัะน ัะปะฐะณ

```
4_pointskomne
```



๐ ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฟัะพะฒะตัะบะฐ ะฒ `bin4.exe` ะฑัะดะตั ััะฟะตัะฝะพ ะฟัะพะนะดะตะฝะฐ ัะพะปัะบะพ ะฟัะธ ะฒะฒะพะดะต ัััะพะบะธ **`"4_pointskomne"`**.


## ๐ ะะตัะตะฝะธะต ะดะปั `bin5.exe`

![ะะตัะตะฝะธะต ะฟััะพะณะพ  ะฑะธะฝะฐัะฝะธะบะฐ](./assets/lesson_2_bin5.png)
### ๐ ะฅะพะด ะธััะปะตะดะพะฒะฐะฝะธั

ะัะพะณัะฐะผะผะฐ ะฟะตัะฒัะผ ะดะตะปะพะผ ะบะพะฟะธััะตั ะฒ ะฟะตัะตะผะตะฝะฝัั `Str` c-ัััะพะบั `"f2hwldozg|:wbq"`(15 ัะธะผะฒะพะปะพะฒ). ะะฐะปะตะต ะฟะพะปััะฐะตะผ ะฒะฒะพะด ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะทะฐะฟััะบะฐะตััั ัะธะบะป `for`.

ะัะตะณะพ ะฟัะพะธะทะพะนะดัั 15 ะธัะตัะฐัะธะน, ะฒะฝัััะธ ัะธะบะปะฐ ะฟัะพะธะทะฒะพะดะธััั ะฟัะพะฒะตัะบะฐ  `i + v3[i] != Str[i]`,  ะบะพัะพัะฐั ะฟัะพะฒะตััะตั ะบะฐะถะดัะน ะฒะฒะตะดัะฝัะน ัะธะผะฒะพะป ะฝะฐ ัะพะพัะฒะตัััะฒะธะต ั `"ะบะปััะพะผ" Str` ะฟัะธ ะฒะพะทะฒัะฐัะต ะฟะพะปะพะถะธัะตะปัะฝะพะณะพ ะทะฝะฐัะตะฝะธั ะทะฐะฒะตััะฐะตั ัะฐะฑะพัั ะฟัะพะณัะฐะผะผั.

ะขะพัะฝะตะต ะฑัะดะตั ัะบะฐะทะฐัั, ััะพ `Str` - ััะพ ัะถะต ะทะฐัะธััะพะฒะฐะฝะฝัะน ะฟะฐัะพะปั, ะฐ ะตะณะพ ัะฐััะธััะพะฒะบะฐ ะฟัะพะธััะพะดะธั "ะฝะฐ ะปะตัั".

ะะพะถะตะผ ะดะปั ัะดะพะฑััะฒะฐ ะฟะตัะตะฟะธัะฐัั ััะพ ััะปะพะฒะธะต ะฒ ะฒััะฐะถะตะฝะธะต ะธ ะฝะฐะฟะธัะตะผ ะฟัะพะณัะฐะผะผั ะดะปั ัะพะทะดะฐะฝะธั ะฟะฐัะพะปั ะฟะพ ะบะปััั `Str`:

1. ะััะฐะถะตะฝะธะต
> v3[i] = Str[i] - i

2. ะะฐะปะตะฝัะบะฐั ะฟัะพะณัะฐะผะผะฐ:
```python
KEY = "f2hwldozg|:wbq"

chars = []

for i, char in enumerate(KEY):
	new_char = chr(ord(char) - i)
	chars.append(new_char)
	
password = "".join(chars)

print(password) # ะัะฒะพะด: f1fth_is_s0lVd
```

### โ ะัะพะณะพะฒัะน ะฟะฐัะพะปั

```
f1fth_is_s0lVd
```



๐ ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฟัะพะฒะตัะบะฐ ะฒ `bin5.exe` ะฑัะดะตั ััะฟะตัะฝะพ ะฟัะพะนะดะตะฝะฐ ัะพะปัะบะพ ะฟัะธ ะฒะฒะพะดะต ัััะพะบะธ **`"f1fth_is_s0lVd"`**.